import assert from 'assert'
import replace from '../src/replace.mjs'
import b642u8arr from '../src/b642u8arr.mjs'
import getDataFromExcelFileU8Arr from '../src/getDataFromExcelFileU8Arr.mjs'


describe(`getDataFromExcelFileU8Arr`, function() {

    let c = `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`
    let u8a = b642u8arr(c)
    //let u8a = fs.readFileSync(`fn.xlsx`)

    let k
    let o = {}

    k = 0
    o[k] = {
        in: { fmt: 'ltdt' },
        out: {
            id: '2',
            proj_no: '93002815',
            hole_no: 'BH-1',
            top_depth: '23',
            bottom_depth: '25',
            core_shape1: 'false',
            core_shape2: 'false',
            core_shape3: 'false',
            core_shape4: 'true',
            core_shape5: 'true',
            core_shape6: 'true',
            core_shape7: 'true',
            core_shape8: 'false'
        }
    }
    it(`should return ${JSON.stringify(o[k].out)} when input ${JSON.stringify(o[k].in)}`, function() {
        let k = 0
        let r = getDataFromExcelFileU8Arr(u8a, o[k].in)
        r = r[0].data[1]
        assert.strict.deepStrictEqual(r, o[k].out)
    })

    k = 1
    o[k] = {
        in: { fmt: 'ltdt', valueToString: false },
        out: {
            id: 2,
            proj_no: 93002815,
            hole_no: 'BH-1',
            top_depth: 23,
            bottom_depth: 25,
            core_shape1: false,
            core_shape2: false,
            core_shape3: false,
            core_shape4: true,
            core_shape5: true,
            core_shape6: true,
            core_shape7: true,
            core_shape8: false
        }
    }
    it(`should return ${JSON.stringify(o[k].out)} when input ${JSON.stringify(o[k].in)}`, function() {
        let k = 1
        let r = getDataFromExcelFileU8Arr(u8a, o[k].in)
        r = r[0].data[1]
        assert.strict.deepStrictEqual(r, o[k].out)
    })

    k = 2
    o[k] = {
        in: { fmt: 'csv' },
        out: `"id","proj_no","hole_no","top_depth","bottom_depth","core_shape1","core_shape2","core_shape3","core_shape4","core_shape5","core_shape6","core_shape7","core_shape8"
"1","61602905740006","BH-6","0","1","false","false","false","false","false","false","false","false"
"2","93002815","BH-1","23","25","false","false","false","true","true","true","true","false"`
    }
    it(`should return ${JSON.stringify(o[k].out)} when input ${JSON.stringify(o[k].in)}`, function() {
        let k = 2
        let r = getDataFromExcelFileU8Arr(u8a, o[k].in)
        r = replace(r[0].data, '\r\n', '\n')
        assert.strict.deepStrictEqual(r, o[k].out)
    })

    k = 3
    o[k] = {
        in: { fmt: 'csv', valueToString: false },
        out: `id,proj_no,hole_no,top_depth,bottom_depth,core_shape1,core_shape2,core_shape3,core_shape4,core_shape5,core_shape6,core_shape7,core_shape8
1,61602905740006,BH-6,0,1,false,false,false,false,false,false,false,false
2,93002815,BH-1,23,25,false,false,false,true,true,true,true,false`
    }
    it(`should return ${JSON.stringify(o[k].out)} when input ${JSON.stringify(o[k].in)}`, function() {
        let k = 3
        let r = getDataFromExcelFileU8Arr(u8a, o[k].in)
        r = replace(r[0].data, '\r\n', '\n')
        assert.strict.deepStrictEqual(r, o[k].out)
    })

    k = 4
    o[k] = {
        in: { fmt: 'array' },
        out: [
            '1', '61602905740006',
            'BH-6', '0',
            '1', 'false',
            'false', 'false',
            'false', 'false',
            'false', 'false',
            'false'
        ]
    }
    it(`should return ${JSON.stringify(o[k].out)} when input ${JSON.stringify(o[k].in)}`, function() {
        let k = 4
        let r = getDataFromExcelFileU8Arr(u8a, o[k].in)
        r = r[0].data[1]
        assert.strict.deepStrictEqual(r, o[k].out)
    })

    k = 5
    o[k] = {
        in: { fmt: 'array', valueToString: false },
        out: [
            1, 61602905740006,
            'BH-6', 0,
            1, false,
            false, false,
            false, false,
            false, false,
            false
        ]
    }
    it(`should return ${JSON.stringify(o[k].out)} when input ${JSON.stringify(o[k].in)}`, function() {
        let k = 5
        let r = getDataFromExcelFileU8Arr(u8a, o[k].in)
        r = r[0].data[1]
        assert.strict.deepStrictEqual(r, o[k].out)
    })

})
